#ifndef AUTO_EXPLOIT_UTILS_H
#define AUTO_EXPLOIT_UTILS_H

#include <stdio.h>
#include <stdlib.h>
#include <sys/auxv.h>
#include <unistd.h>
#include <stdarg.h>

#define MAX_FILENAME 100
#define MAX_COMMAND 250
#define MAX_PAYLOAD 1000
#define NOP_SLOPE_OFFSET 50

#define DEFAULT_LOG_LEVEL ERR

extern char *OVERFLOW_PATTERN;
extern char *BUFFER_PATTERN;

typedef enum {
    SILENT,
    ERR,
    WARN,
    INFO,
} LOG_LEVEL;

typedef enum {
    E_INCORRECT_PARAM = 1,
    E_ASLR_ENABLED,
    E_FAILED_COPY_TARGET_PROGRAM,
    E_TARGET_PROGRAM_FILE_NOT_FOUND,
    E_OBJDUMP_FAILED,
    E_NO_VULN_FUNCTIONS,
    E_FAILED_TO_START_TARGET_PROGRAM,
    E_MAX_PAYLOAD,
    E_STDIN_INPUT_METHOD,
    E_NO_BUFFER_SIZE,
    E_INVALID_EIP_OFFSET,
    E_FAILED_START_DEBUGGER,
    E_FAILED_CREATE_CHILD_PROCESS,
    E_FAILED_OPEN_TARGET_FILE_COPY,
    E_NO_TARGET_PROGRAM_SPECIFIED
} ERROR;

typedef enum {
    W_FAILED_TO_OPEN_ASLR_FILE = 1,
    W_NO_INPUT_METHOD_SPECIFIED
} WARNING;

void error_exit(ERROR error);

void warning(WARNING warn);

void info(char *msg, ...);

int is_aslr_enabled();

int does_file_exist(char *filename);

void set_log_level(int level);

#endif //AUTO_EXPLOIT_UTILS_H
